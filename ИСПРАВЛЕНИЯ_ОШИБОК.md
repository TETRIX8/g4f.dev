# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ setTimeout –≤ Google Apps Script

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
```
ReferenceError: setTimeout is not defined
```

**–ü—Ä–∏—á–∏–Ω–∞:** Google Apps Script –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–µ–±-—Ñ—É–Ω–∫—Ü–∏–∏ `setTimeout`, `clearTimeout`, `setInterval` –∏ –¥—Ä—É–≥–∏–µ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### üîÑ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

#### 1. **–£–±—Ä–∞–Ω—ã –≤—Å–µ setTimeout/clearTimeout**
```javascript
// ‚ùå –ë–´–õ–û (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Google Apps Script):
setTimeout(() => saveToCacheService(products, hash), 0);
setTimeout(preloadData, 100);

// ‚úÖ –°–¢–ê–õ–û (—Ä–∞–±–æ—Ç–∞–µ—Ç):
saveToCacheService(products, hash);
// preloadData –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏
```

#### 2. **–£–ø—Ä–æ—â–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤**
```javascript
// ‚ùå –ë–´–õ–û:
if (this.logBuffer.length >= 10) {
  flushLogBuffer();
} else if (!this.logFlushTimer) {
  this.logFlushTimer = setTimeout(flushLogBuffer, 5000);
}

// ‚úÖ –°–¢–ê–õ–û:
// –ü—Ä—è–º–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –±–µ–∑ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏
const cache = CacheService.getUserCache();
const existingLogs = JSON.parse(cache.get("logs_ultra_v3_fixed") || "[]");
existingLogs.push(logEntry);
cache.put("logs_ultra_v3_fixed", JSON.stringify(existingLogs), 3600);
```

#### 3. **–ó–∞–º–µ–Ω–µ–Ω—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
```javascript
// ‚ùå –ë–´–õ–û:
setTimeout(() => saveToAllCachesAsync(products, hash), 0);

// ‚úÖ –°–¢–ê–õ–û:
saveToAllCaches(products, hash); // –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```

#### 4. **–û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–ª—é—á–∏ –∫–µ—à–∞**
```javascript
// –ù–æ–≤—ã–µ –∫–ª—é—á–∏ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:
"products_ultra_v6_fixed"     // –≤–º–µ—Å—Ç–æ "products_ultra_v6"
"logs_ultra_v3_fixed"         // –≤–º–µ—Å—Ç–æ "logs_ultra_v3"
```

## üìÅ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª: `fixed_ultra_optimized_script.js`
- ‚úÖ –£–±—Ä–∞–Ω—ã –≤—Å–µ setTimeout/clearTimeout
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- `menu_and_buttons.js` - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- `drawing_buttons.js` - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–º–µ–Ω–∞

### –ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç:
1. –ó–∞–º–µ–Ω–∏—Ç–µ –≤–µ—Å—å –∫–æ–¥ –Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `fixed_ultra_optimized_script.js`
2. –î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω–µ—Ü –∫–æ–¥ –∏–∑ `menu_and_buttons.js` (–¥–ª—è –º–µ–Ω—é)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç (Ctrl+S)
4. –û–±–Ω–æ–≤–∏—Ç–µ Google Sheets

### –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –≤–ø–µ—Ä–≤—ã–µ:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `fixed_ultra_optimized_script.js` –∫–∞–∫ –æ—Å–Ω–æ–≤—É
2. –î–æ–±–∞–≤—å—Ç–µ `menu_and_buttons.js` –¥–ª—è –∫–Ω–æ–ø–æ–∫
3. –î–æ–±–∞–≤—å—Ç–µ `Logs.html` –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ª–æ–≥–æ–≤
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `CACHE_FILE_ID`

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Sheets
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –º–µ–Ω—é "üîç –®—Ç—Ä–∏—Ö-–∫–æ–¥—ã"
3. –ù–∞–∂–º–∏—Ç–µ "üìã –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏" - –¥–æ–ª–∂–Ω—ã –æ—Ç–∫—Ä—ã—Ç—å—Å—è –ª–æ–≥–∏
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ —à—Ç—Ä–∏—Ö-–∫–æ–¥ –≤ –∫–æ–ª–æ–Ω–∫—É B
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫:
```
15:30:42.123 | üéØ onEdit: –ª–∏—Å—Ç="4 –ü—Ä–æ–¥–∞–∂–∏", —è—á–µ–π–∫–∞=B5, —Å—Ç—Ä–æ–∫–∞=5, –∫–æ–ª–æ–Ω–∫–∞=2
15:30:42.125 | ‚è±Ô∏è onEdit_quickCheck: 2ms | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞
15:30:42.127 | ‚è±Ô∏è getValue: 1ms | –ó–Ω–∞—á–µ–Ω–∏–µ: "1234567890"
15:30:42.128 | üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞: "1234567890"
15:30:42.129 | ‚è±Ô∏è productSearch: 1ms | –ù–∞–π–¥–µ–Ω: –¢–æ–≤–∞—Ä ABC
15:30:42.135 | ‚è±Ô∏è batchUpdate: 6ms | –û–±–Ω–æ–≤–ª–µ–Ω–æ 4 —è—á–µ–µ–∫
```

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏

### 1. **–ë–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –ü—Ä—è–º–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–µ–∑ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏
- –ú–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –ª–æ–≥–æ–≤

### 2. **–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- –£–±—Ä–∞–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã
- –ë–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –õ–µ–≥—á–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

### 3. **–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª–∏—Å—å
- –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:
showLogs()                    // –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
showPerformanceReport()       // –û—Ç—á—ë—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
advancedPerformanceTest()     // –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
forceRefreshCache()          // –û–±–Ω–æ–≤–∏—Ç—å –∫–µ—à
testFind()                   // –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞
```

### –ß—Ç–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ
- ‚úÖ –ü–æ–∫–∞–∑ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É/–º–µ–Ω—é

## üö® –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –µ—Å—Ç—å –æ—à–∏–±–∫–∏

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ**:
   ```javascript
   const CACHE_FILE_ID = "–≤–∞—à_—Ä–µ–∞–ª—å–Ω—ã–π_ID_—Ñ–∞–π–ª–∞";
   ```

2. **–ù–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã**:
   ```javascript
   const SHEET_PRODUCTS = "1. –¢–æ–≤–∞—Ä—ã";  // –¢–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
   const SHEET_PURCHASES = "3 –ó–∞–∫—É–ø–∫–∏";
   const SHEET_SALES = "4 –ü—Ä–æ–¥–∞–∂–∏";
   ```

3. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º**:
   - JSON —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏
   - –°–∫—Ä–∏–ø—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–∞–±–æ—Ç—É —Å Google Sheets

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏:
```javascript
// –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º:
showLogs()

// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:
showPerformanceReport()
```

---

## ‚úÖ –ò—Ç–æ–≥

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å Google Apps Script** –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ–±-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã.

**–§–∞–π–ª –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: `fixed_ultra_optimized_script.js`** üéØ